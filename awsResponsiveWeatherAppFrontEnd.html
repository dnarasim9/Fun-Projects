<!DOCTYPE html>
<html lang="en">
<head>
  <title>Weather Forecast</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.14.0/jquery.validate.min.js"></script>    
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.14.0/jquery.validate.js"></script>

  <script src="http://openweathermap.org/js/OWM.OpenLayers.1.3.4.js" ></script>
  <script src="http://openlayers.org/api/OpenLayers.js"> </script>
  <script src='http://connect.facebook.net/en_US/all.js'></script>

    <style>

		@media(max-width:767px){
			.next7DaysVisualWell {
				margin: 5px 0px;
			}
		}
		@media(min-width:768px){
			.next7DaysVisualWell {
				margin: 5px 0px;
			}
		}
		@media(min-width:992px){
			.next7DaysVisualWell {
				margin: 10px 5px;
			}
		}
		@media(min-width:1200px){
			.next7DaysVisualWell {
				margin: 10px 5px;
			}
		}

		.formdiv {
			background: rgba(0,0,0,.3);
			border-color:rgba(220, 220, 220, 0);
			opacity: 1;
			height: block;
		}


		#basicMap {
			height : 437px;
		}

        	#asterisk{
            		color: red;
        	}
        	#label{
            color: white;
        }
        .err{
            color: red;
        }

        #messages{
           color:red;
       	}

       	label.error{
           color: red;
       	}

       	#next24HourTableData{
            text-align: center;
        }

		.nav-tabs > li.active > a {
           background-color: #367DB5 !important;
           color: white;
       	}

    </style>
    <script>


    $(document).ready(function () {

  
            validator=$('#myform').validate({
                rules: {
                    address: {
                       required: true                       
                    },
    
                    city: {
                        required: true                       
                    },

                    state: {
                        required: true
                    }
                },


                messages: {
                    address: {
                        required:"Please enter the street address"
                    },

                    city: {
                        required:"Please enter the city"
                    },

                    state: {
                        required: "Please select a state"
                    }
 
                }
            });
        });


        

        $(function() {


            $("#search").click(function() {                

                var address = $("#address").val();
                var city = $("#city").val();
                var state = $("#state").val();
                var reg=/[^\s]/;

                if(!$("#myform").valid())
                {

                    return false;
                }

            else
                {
                    console.log("Ajax call");
                    $.ajax({
                                    type: 'GET',
                                    url: 'index.php',
                                    dataType: 'json',

					data: {
						street : $("#address").val(),
						city : $("#city").val(),
						state : $("#state").val(),
						degree : $("input[name=degree]:checked").val()
					},

					success: function(output){
						console.log("Success function");
						console.log(output);

                        $('#forecastResultsDiv').show();
						$('#weatherTabs a[href="#rightNow"]').tab('show');

						var rightNowIcon = "";
						switch(output.currently.icon)
						{
                                    case 'clear-day': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='100' width='100'>"; break;
                                    case 'clear-night': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='100' width='100'>"; break;
                                    case 'rain': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='100' width='100'>"; break;
                                    case 'snow': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'sleet': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'wind': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'fog':     rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'cloudy': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'partly-cloudy-day': rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                                    case 'partly-cloudy-night':     rightNowIcon="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='" + output.currently.summary + "' alt='"+ output.currently.summary +"' length='125' width='125'>"; break;
                        }

						if($('input[name=degree]:checked').val() == "Fahrenheit") {
						console.log($('input[name=degree]:checked').val());

						var precipIntensityF = "";
							if(output.currently.precipIntensity >= 0 && output.currently.precipIntensity < 0.002) precipIntensityF = "None";
							else if(output.currently.precipIntensity >= 0.002 && output.currently.precipIntensity < 0.017) precipIntensityF = "Very Light";
							else if(output.currently.precipIntensity >= 0.017 && output.currently.precipIntensity < 0.1) precipIntensityF = "Light";
							else if(output.currently.precipIntensity >= 0.1 && output.currently.precipIntensity < 0.4) precipIntensityF = "Moderate";
							else if(output.currently.precipIntensity >= 0.4) precipIntensityF = "Heavy";

						var time = output.daily.data[0].sunriseTime;
						var time1 = output.daily.data[0].sunsetTime;
						console.log(time);



$("#rightNowVisual").html(
								'<div class="row" style="background: #F17D7E">' +
								'<center>' +
									'<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">' +
										rightNowIcon +
									'</div>' +
									'<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">' +
'<span style="color: white;"><b>' + output.currently.summary + ' in ' + $("#city").val() +', '+ $("#state").val() + '</b></span><br><span style="color: white; font-size: 50px;"><b>' + Math.round(output.currently.temperature) +'<span style="font-size: 15px; vertical-align: text-top;">&deg F</span></b></span><br><div id="fb-root"><span style="color: blue;">'+ 'L: ' + Math.round(output.daily.data[0].temperatureMin) + '&deg</span> | <span style="color: green"> H: '+ Math.round(output.daily.data[0].temperatureMax) + '&deg</span>&nbsp;&nbsp' + '<span><img src="http://cs-server.usc.edu:45678/hw/hw8/images/fb_icon.png"; length=40; width=40; id="fbTestBtn"></span><p id="msg"></p></div>' +'</div>'+

									'</div>' +

								'</center>' +
								'<div>' +
								'<div class="row">' +
									'<div class="table-responsive"><table class="table table-striped">'+
										'<tr><td>Precipitation</td><td>' + precipIntensityF + '</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Chance of Rain</td><td>' + Math.round(output.currently.precipProbability * 100) + ' %</td></tr>'+
										'<tr><td>Wind Speed</td><td>' + (output.currently.windSpeed).toFixed(2) + ' mph</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Dew Point</td><td>' + (output.currently.dewPoint).toFixed(2) + '&deg F</td></tr>'+
										'<tr><td>Humidity</td><td>' + Math.round(output.currently.humidity * 100) + ' %</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Visibility</td><td>' + (output.currently.visibility).toFixed(2) + ' mi</td></tr>'+
										'<tr><td>Sunrise</td><td>' + timeFormatter(output.daily.data[0].sunriseTime) + '</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Sunset</td><td>' + timeFormatter(output.daily.data[0].sunsetTime) + '</td></tr>'+
									'</table></div>' +
								'</div>'
							);

if($('#weatherTabs li.active').text() == "Right Now") {
								$('#fbTestBtn').click(function(e){
									console.log("fb button was clicked");

									var fbpicture = "";
									switch(output.currently.icon)
									{
										case 'clear-day': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png'; break;
										case 'clear-night': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png'; break;
										case 'rain': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png'; break;
										case 'snow': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png'; break;
										case 'sleet': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png'; break;
										case 'wind': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png'; break;
										case 'fog':	fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png'; break;
										case 'cloudy': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png'; break;
										case 'partly-cloudy-day': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png'; break;
										case 'partly-cloudy-night':	fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png'; break;
									}

									var fbname = 'Current Weather in ' + $("#city").val() +', '+ $("#state").val();
									var fbdesc = output.currently.summary + ', ' + Math.round(output.currently.temperature) + '\xB0F';

									console.log("fbpicture - " + fbpicture + " fbname - " + fbname + " fbdesc - " + fbdesc);
									FB.init({appId: "1705808262988350", status: true, cookie: true});
									postToFeed(fbpicture, fbname, fbdesc);
								});

								$('#rightNowMap').html('<div id="basicMap"></div>');
								createMap(output.latitude, output.longitude);
								console.log($('#weatherTabs li.active').text());
							}



var next24HourVisual = '<div class="table-responsive"><table class="table table-striped" id="next24HourTableData"><tr style="background-color:#367DB5; text-align:center" id="next24HourTableHeaderRow"><th style="color: white;text-align:center">Time</th><th style="color: white;text-align:center">Summary</th><th style="color: white;text-align:center">Cloud Cover</th><th style="color: white;text-align:center">Temp (&degF)</th><th style="color: white;text-align:center">View Details</th></tr>';

							for(var i = 1; i < 25; i++) {
								console.log(i);

								var icon24Hour = "";
								switch(output.hourly.data[i].icon)
								{
									case 'clear-day': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>";	break;
									case 'clear-night': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'rain': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'snow': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'sleet': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'wind': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'fog':	icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'cloudy': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-day': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-night':	icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
								}

								next24HourVisual += '<tr style="background: white;"><td>' + timeFormatter(output.hourly.data[i].time) + '</td><td>' + icon24Hour + '</td><td>' + (output.hourly.data[i].cloudCover * 100).toFixed(0) + '%</td><td>' + output.hourly.data[i].temperature + '</td><td><span class="glyphicon glyphicon-plus" style="color: #3071A9" data-toggle="collapse" data-target="#viewDetail'+ i +'" aria-expanded="false" aria-controls="viewDetail'+ i +'" aria-hidden="true"></span></td></tr>';
								next24HourVisual += '<tr style="background: #F9F9F9;" class="collapse" id="viewDetail'+ i +'"><td colspan="5">';
								next24HourVisual += '<div class="table-responsive"><table class="table table-striped"><tr style="background: white;"><th style="text-align:center">Wind</th><th style="text-align:center">Humidity</th><th style="text-align:center">Visibility</th><th style="text-align:center">Pressure</th></tr>';
								next24HourVisual += '<tr style="background: #F9F9F9;"><td>' + (output.hourly.data[i].windSpeed).toFixed(2) + ' mph</td><td>' + Math.round(output.hourly.data[i].humidity * 100) + ' %</td><td>' + (output.hourly.data[i].visibility).toFixed(2) + ' mi</td><td>' + output.hourly.data[i].pressure + ' mb</td></tr>';
								next24HourVisual += '</table></div>';
								next24HourVisual += '</td></tr>';
							}
							next24HourVisual += '</table></div>';
							$("#next24HoursVisual").html(next24HourVisual);




var next7DaysVisual = "";
							next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div>'
                                                        for(var j = 1; j < 8; j++) {

                                                                var icon7days = "";
                                                                switch(output.daily.data[j].icon)
                                                                {
                                                                        case 'clear-day': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>";    break;
                                                                        case 'clear-night': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'rain': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'snow': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'sleet': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'wind': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'fog':     icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'cloudy': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'partly-cloudy-day': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                        case 'partly-cloudy-night':     icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
                                                                }

                                                                var icon7daysModal = "";
                                                                switch(output.daily.data[j].icon)
                                                                {
                                                                        case 'clear-day': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>";     break;
                                                                        case 'clear-night': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'rain': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'snow': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'sleet': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'wind': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'fog':     icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'cloudy': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'partly-cloudy-day': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
                                                                        case 'partly-cloudy-night':     icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;    
                                                                }

                                                                var visibility7Days = "N.A.";
                                                                if (output.daily.data[j].visibility != undefined) {
                                                                        visibility7Days = (output.daily.data[j].visibility).toFixed(2) + ' mi';
                                                                }
                                                                if(j==1){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#367DB5;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                else if(j==2){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#EC4444;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                 else if(j==3){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#E68E4F;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                else if(j==4){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#A7A439;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                else if(j==5){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#9770A7;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                else if(j==6){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#F37C7E;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';

                                                                }
                                                                else if(j==7){
                                                                next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 next7DaysTab" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#CE4571;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                            }

                                                                next7DaysVisual += '<div class="modal fade" id="myModal'+j+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">';
                                                                next7DaysVisual +=   '<div class="modal-dialog" role="document">';
                                                                next7DaysVisual +=      '<div class="modal-content">';
                                                                next7DaysVisual +=        '<div class="modal-header">';
                                                               next7DaysVisual +=              '<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';
                                                                next7DaysVisual +=              '<h4 class="modal-title" id="myModalLabel">Weather in '+ $("#city").val() + ' on ' + getTimeStampMonthDate(output.daily.data[j].time) +'</h4>';
                                                                next7DaysVisual +=        '</div>';
                                                                next7DaysVisual +=        '<div class="modal-body">';
                                                                next7DaysVisual +=              '<center>' + icon7daysModal + '<br><span style="font-size: 30px;">' + getTimeStampDay(output.daily.data[j].time) + ': <span style="color: #FEA502;">' + output.daily.data[j].summary + '</span></span></center>';
                                                                next7DaysVisual +=      '<div class="row">';
                                                                next7DaysVisual +=              '<center>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Sunrise Time </b></span><br><span>' + timeFormatter(output.daily.data[j].sunriseTime) + '</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Sunset Time </b></span><br><span>' + timeFormatter(output.daily.data[j].sunsetTime) + '</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Humidity </b></span><br><span>' + Math.round(output.daily.data[j].humidity * 100) + ' %</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=              '</center>';
                                                                next7DaysVisual +=              '</div>';
                                                                next7DaysVisual +=              '<div class="row">';
                                                                next7DaysVisual +=              '<center>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Wind Speed </b></span><br><span>' + (output.daily.data[j].windSpeed).toFixed(2) + ' mph</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Visibility </b></span><br><span>' + visibility7Days + '</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=                      '<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
                                                                next7DaysVisual +=                              '<span style="font-size: 20px;"><b> Pressure </b></span><br><span>' + output.daily.data[j].pressure + ' mb</span>';
                                                                next7DaysVisual +=                      '</div>';
                                                                next7DaysVisual +=              '</center>';
                                                                 next7DaysVisual +=              '</div>';
                                                                next7DaysVisual +=        '</div>';
                                                                next7DaysVisual +=        '<div class="modal-footer">';
                                                                next7DaysVisual +=              '<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>';
                                                                next7DaysVisual +=        '</div>';
                                                                next7DaysVisual +=      '</div>';
                                                                next7DaysVisual +=   '</div>';
                                                                next7DaysVisual += '</div>';
                                                        }
                                                        next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div>';
                                                        $("#next7DaysVisual").html(next7DaysVisual);
                                                }





if($('input[name=degree]:checked').val() == "Celsius") {
							console.log($('input[name=degree]:checked').val())

							var precipIntensityC = "";
							var ocp = (output.currently.precipIntensity / 25.4)
							if(ocp >= 0 && ocp < 0.002) precipIntensityC = "None";
							else if(ocp >= 0.002 && ocp < 0.017) precipIntensityC = "Very Light";
							else if(ocp >= 0.017 && ocp < 0.1) precipIntensityC = "Light";
							else if(ocp >= 0.1 && ocp < 0.4) precipIntensityC = "Moderate";
							else if(ocp >= 0.4) precipIntensityC = "Heavy";

							$('#rightNowVisual').html(
								'<div class="row" style="background: #F17D7E">' +
								'<center>' +
									'<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">' +
										rightNowIcon +
									'</div>' +
									'<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">' +
										'<span style="color: white;"><b>' + output.currently.summary + ' in ' + $("#city").val() +', '+ $("#state").val() + '</b></span><br><span style="color: white; font-size: 50px;"><b>' + Math.round(output.currently.temperature) +'<span style="font-size: 15px; vertical-align: text-top;">&deg C</span></b></span><br><div id="fb-root"><span style="color: blue;">'+ 'L: ' + Math.round(output.daily.data[0].temperatureMin) + '&deg</span> | <span style="color: green"> H: '+ Math.round(output.daily.data[0].temperatureMax) + '&deg</span>&nbsp;&nbsp' + '<img src="http://cs-server.usc.edu:45678/hw/hw8/images/fb_icon.png" id="fbTestBtn" title="Facebook Post" length="40" width="40"></span><p id="msg"></p>' +'</div>'+
									'</div>' + '</div>' +
								'</center>' +
								'<div>' +
								'<div class="row">' +
									'<div class="table-responsive"><table class="table table-striped">'+
										'<tr><td>Precipitation</td><td>' + precipIntensityC + '</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Chance of Rain</td><td>' + Math.round(output.currently.precipProbability * 100) + ' %</td></tr>'+
										'<tr><td>Wind Speed</td><td>' + (output.currently.windSpeed).toFixed(2) + ' m/s</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Dew Point</td><td>' + (output.currently.dewPoint).toFixed(2) + '&deg C</td></tr>'+
										'<tr><td>Humidity</td><td>' + Math.round(output.currently.humidity * 100) + ' %</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Visibility</td><td>' + (output.currently.visibility).toFixed(2) + ' km</td></tr>'+
										'<tr><td>Sunrise</td><td>' + timeFormatter(output.daily.data[0].sunriseTime) + '</td></tr>'+
										'<tr style="background: #F1DDDD"><td>Sunset</td><td>' + timeFormatter(output.daily.data[0].sunsetTime) + '</td></tr>'+
									'</table></div>' +
								'</div>'
							);




if($('#weatherTabs li.active').text() == "Right Now") {
								$('#fbTestBtn').click(function(e){
									console.log("fb button was clicked");

									var fbpicture = "";
									switch(output.currently.icon)
									{
										case 'clear-day': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png'; break;
										case 'clear-night': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png'; break;
										case 'rain': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png'; break;
										case 'snow': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png'; break;
										case 'sleet': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png'; break;
										case 'wind': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png'; break;
										case 'fog':	fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png'; break;
										case 'cloudy': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png'; break;
										case 'partly-cloudy-day': fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png'; break;
										case 'partly-cloudy-night':	fbpicture='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png'; break;
									}

									var fbname = 'Current Weather in ' + $("#city").val() +', '+ $("#state").val();
									var fbdesc = output.currently.summary + ', ' + Math.round(output.currently.temperature) + '\xB0C';

									console.log("fbpicture - " + fbpicture + " fbname - " + fbname + " fbdesc - " + fbdesc);
									FB.init({appId: "1705808262988350", status: true, cookie: true});
									postToFeed(fbpicture, fbname, fbdesc);
								});

								$('#rightNowMap').html('<div id="basicMap"></div>');
								createMap(output.latitude, output.longitude);
								console.log($('#weatherTabs li.active').text());
							}




var next24HourVisual = '<div class="table-responsive"><table class="table table-striped" id="next24HourTableData"><tr style="background-color:#367DB5;" id="next24HourTableHeaderRow"><th style="color: white;text-align:center">Time</th><th style="color: white;text-align:center">Summary</th><th style="color: white;text-align:center">Cloud Cover</th><th style="color: white;text-align:center">Temp (&degC)</th><th style="color: white;text-align:center">View Details</th></tr>';
							for(var i = 1; i < 25; i++) {
								console.log(i);

								var icon24Hour = "";
								switch(output.hourly.data[i].icon)
								{
									case 'clear-day': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>";	break;
									case 'clear-night': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'rain': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'snow': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'sleet': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'wind': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'fog':	icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'cloudy': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-day': icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-night':	icon24Hour="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='" + output.hourly.data[i].summary + "' alt='"+ output.hourly.data[i].summary +"' length='30' width='30'>"; break;
								}

								next24HourVisual += '<tr style="background: white;"><td>' + timeFormatter(output.hourly.data[i].time) + '</td><td>' + icon24Hour + '</td><td>' + (output.hourly.data[i].cloudCover * 100).toFixed(0) + '%</td><td>' + output.hourly.data[i].temperature + '</td><td><span class="glyphicon glyphicon-plus" style="color: #3071A9" data-toggle="collapse" data-target="#viewDetail'+ i +'" aria-expanded="false" aria-controls="viewDetail'+ i +'" aria-hidden="true"></span></td></tr>';
								next24HourVisual += '<tr style="background: #F9F9F9;" class="collapse" id="viewDetail'+ i +'"><td colspan="5">';
								next24HourVisual += '<div class="table-responsive"><table class="table table-striped"><tr style="background: white;"><th style="text-align:center">Wind</th><th style="text-align:center">Humidity</th><th style="text-align:center">Visibility</th><th style="text-align:center">Pressure</th></tr>';
								next24HourVisual += '<tr style="background: #F9F9F9;"><td style="text-align:center">' + (output.hourly.data[i].windSpeed).toFixed(2) + ' m/s</td><td style="text-align:center">' + Math.round(output.hourly.data[i].humidity * 100) + ' %</td><td style="text-align:center">' + (output.hourly.data[i].visibility).toFixed(2) + ' km</td><td style="text-align:center">' + output.hourly.data[i].pressure + ' hPa</td></tr>';
								next24HourVisual += '</table></div>';
								next24HourVisual += '</td></tr>';
							}
							next24HourVisual += '</table></div>';
							$("#next24HoursVisual").html(next24HourVisual);

							var next7DaysVisual = "";
							next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div>'
							for(var j = 1; j < 8; j++) {

								var icon7days = "";
								switch(output.daily.data[j].icon)
								{
									case 'clear-day': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>";	break;
									case 'clear-night': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'rain': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'snow': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'sleet': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'wind': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'fog':	icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'cloudy': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-day': icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
									case 'partly-cloudy-night':	icon7days="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='30' width='30'>"; break;
								}

								var icon7daysModal = "";
								switch(output.daily.data[j].icon)
								{
									case 'clear-day': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>";	break;
									case 'clear-night': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/clear_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'rain': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/rain.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'snow': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/snow.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'sleet': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/sleet.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'wind': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/wind.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'fog':	icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/fog.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'cloudy': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloudy.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'partly-cloudy-day': icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_day.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
									case 'partly-cloudy-night':	icon7daysModal="<img src='http://cs-server.usc.edu:45678/hw/hw8/images/cloud_night.png' title='"+ output.daily.data[j].summary +"' alt='"+ output.daily.data[j].summary +"' length='125' width='125'>"; break;
								}

								var visibility7Days = "N.A.";
								if (output.daily.data[j].visibility != undefined) {
									visibility7Days = (output.daily.data[j].visibility).toFixed(2) + ' km';
								}

								if(j==1){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#367DB5;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==2){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#EC4444;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==3){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#E68E4F;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==4){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#A7A439;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==5){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#9770A7;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==6){
                                                                    next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#F37C7E;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                                }
                                                                if(j==7){
                                                                next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1 nextsevendaystyle" style="border-radius: 5px; padding-left: 0; padding-right:0;background-color:#CE4571;" id="next7Hours'+ j +'" data-toggle="modal" data-target="#myModal'+j+'"><center>' + '<span style="color: white; font-size:13px;"><b>' + getTimeStampDay(output.daily.data[j].time)+ '</b></span>' +'<br><br><span style="color: white; font-size:13px;"><b>'+ getTimeStampMonthDate(output.daily.data[j].time) +'</b></span><br><br>'+ icon7days +'<br><br><span style="color: white; font-size:13px;"> Min <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMin +'&deg</span><br><br><span style="color: white; font-size:13px;"> Max <br> Temp </span><br><br><span style="color: white; font-size:20px;"><b>'+ output.daily.data[j].temperatureMax + '&deg</b></span></center></div>';
                                                            }
								next7DaysVisual += '<div class="modal fade" id="myModal'+j+'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">';
								next7DaysVisual +=   '<div class="modal-dialog" role="document">';
								next7DaysVisual += 	'<div class="modal-content">';
								next7DaysVisual += 	  '<div class="modal-header">';
								next7DaysVisual += 		'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>';
								next7DaysVisual += 		'<h4 class="modal-title" id="myModalLabel">Weather in '+ $("#city").val() + ' on ' + getTimeStampMonthDate(output.daily.data[j].time) +'</h4>';
								next7DaysVisual += 	  '</div>';
								next7DaysVisual += 	  '<div class="modal-body">';
								next7DaysVisual += 		'<center>' + icon7daysModal + '<br><span style="font-size: 30px;">' + getTimeStampDay(output.daily.data[j].time) + ': <span style="color: #FEA502;">' + output.daily.data[j].summary + '</span></span></center>';
								next7DaysVisual +=    	'<div class="row">';
								next7DaysVisual +=		'<center>';
								next7DaysVisual +=	  		'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Sunrise Time </b></span><br><span>' + timeFormatter(output.daily.data[j].sunriseTime) + '</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=			'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Sunset Time </b></span><br><span>' + timeFormatter(output.daily.data[j].sunsetTime) + '</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=			'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Humidity </b></span><br><span>' + Math.round(output.daily.data[j].humidity * 100) + ' %</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=		'</center>';
								next7DaysVisual +=		'</div>';
								next7DaysVisual +=		'<div class="row">';
								next7DaysVisual +=		'<center>';
								next7DaysVisual +=			'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Wind Speed </b></span><br><span>' + (output.daily.data[j].windSpeed).toFixed(2) + ' m/s</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=			'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Visibility </b></span><br><span>' + visibility7Days + '</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=			'<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">';
								next7DaysVisual +=				'<span style="font-size: 20px;"><b> Pressure </b></span><br><span>' + output.daily.data[j].pressure + ' hPa</span>';
								next7DaysVisual +=			'</div>';
								next7DaysVisual +=		'</center>';
								next7DaysVisual +=		'</div>';
								next7DaysVisual += 	  '</div>';
								next7DaysVisual += 	  '<div class="modal-footer">';
								next7DaysVisual += 		'<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>';
								next7DaysVisual += 	  '</div>';
								next7DaysVisual += 	'</div>';
								next7DaysVisual +=   '</div>';
								next7DaysVisual += '</div>';
							}
							next7DaysVisual += '<div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div><div class="col-xs-12 col-sm-12 col-md-1 col-lg-1"></div>';
							$('#next7DaysVisual').html(next7DaysVisual);
						}

						activateTabs();
					},
					error: function(){

					}
				});

		}


    });






FB.init({appId: "1705808262988350", status: true, cookie: true});
  function postToFeed(picture, name, description) {
			// calling the API ...
			var obj = {
			  method: 'feed',
			  redirect_uri: 'http://awsdheemanth-env.elasticbeanstalk.com/dhnhomework8.html',
			  link: 'http://forecast.io/',
			  picture: picture,
			  name: name,
			  caption: 'WEATHER INFORMATION FROM FORECAST.IO',
			  description: description
			};

			function callback(response) {
			  //document.getElementById('msg').innerHTML = "Post ID: " + response['post_id'];
			  if(response['post_id']) {
				  alert("Posted Successfully")
			  } else {
				  alert("Not Posted");
			  }
			}

			FB.ui(obj, callback);
			//FB.ui(obj);
		  }

/* Convert the timestamp to get Time */
		function timeFormatter(dateTime){
			//multiply by 1000 to convert the unix timestamp to milliseconds
			var date = new Date(dateTime * 1000);
			if (date.getHours()>=12){
				var hour = parseInt(date.getHours()) - 12;
				hour = (hour == '0' ? 12 : hour);
				var amPm = "PM";
			} else {
				var hour = date.getHours();
				hour = (hour == '0' ? 12 : hour);
				var amPm = "AM";
			}
			var time = (hour < 10 ? '0'+hour : hour)   + ":" + (date.getMinutes() < 10 ? '0'+ date.getMinutes() : date.getMinutes()) + " " + amPm;
			console.log(time);
			return time;
		}


function createMap(lat, lon){
			//Center of map
			var map = new OpenLayers.Map("basicMap");
			var fromProjection = new OpenLayers.Projection("EPSG:4326");   // Transform from WGS 1984
			var toProjection   = new OpenLayers.Projection("EPSG:900913"); // to Spherical Mercator Projection
			var position       = new OpenLayers.LonLat(lon, lat).transform( fromProjection, toProjection);
			// Create overlays
			//  OSM
			var mapnik = new OpenLayers.Layer.OSM();
			var layer_cloud = new OpenLayers.Layer.XYZ(
								"clouds",
								"http://${s}.tile.openweathermap.org/map/clouds/${z}/${x}/${y}.png",
								{
									isBaseLayer: false,
									opacity: 0.7,
									sphericalMercator: true
								}
							);
			var layer_precipitation = new OpenLayers.Layer.XYZ(
				"precipitation",
				"http://${s}.tile.openweathermap.org/map/precipitation/${z}/${x}/${y}.png",
				{
					isBaseLayer: false,
					opacity: 0.7,
					sphericalMercator: true
				}
			);
			map.addLayers([mapnik, layer_precipitation, layer_cloud]);
			map.setCenter( position, 8 );
		}

/* Convert the timestamp to get the Day */
		function getTimeStampDay(dateTime) {
			var d = new Date(dateTime * 1000);
			var weekday = new Array(7);
			weekday[0] = "Sunday";
			weekday[1] = "Monday";
			weekday[2] = "Tuesday";
			weekday[3] = "Wednesday";
			weekday[4] = "Thursday";
			weekday[5] = "Friday";
			weekday[6] = "Saturday";

			var n = weekday[d.getDay()];
			return n;
		}

		/* Convert the timestamp to get the month and day/date */
		function getTimeStampMonthDate(dateTime) {
			var d = new Date(dateTime * 1000);
			var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
			var date = d.getDate();

			return monthNames[d.getMonth()] + " " + date;
		}


		/* Activating the nav tabs */
		function activateTabs() {
			$('#weatherTabs a[href="#rightNow"]').click(function (e) {
					$('#weatherTabs a[href="#rightNow"]').tab('show');
			});

			$('#weatherTabs a[href="#next24Hours"]').click(function (e) {
					$('#weatherTabs a[href="#next24Hours"]').tab('show');
			});

			$('#weatherTabs a[href="#next7Days"]').click(function (e) {
					$('#weatherTabs a[href="#next7Days"]').tab('show');
			});
		}
});

		function clearscreen(){
                    window.open('http://awsdheemanth-env.elasticbeanstalk.com/weatherforecast.html','_self');
                }



</script>
</head>


<body style="background: url('http://cs-server.usc.edu:45678/hw/hw8/images/bg.jpg'); background-size: cover; background-repeat: no-repeat; height: block;">


   
    <div class="container">
        <div class="title text-center">
			<h1>Forecast Search</h1>
		</div>
	
	<div class="formdiv">
            <div class="row">
                <section class="col-xs-12">

                    <form name="myform" id="myform" method="get">

                        <div class="form-group">
                            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <label class="control-label" for="address" id="label">Street Address: <span id="asterisk">*</span></label>
                                <input type="text" class="form-control" id="address" name="address" placeholder="Enter street address">
                                <p class="err" id="strerr"></p>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                <label class="control-label" for="city" id="label">City: <span id="asterisk">*</span></label>
                                <input type="text" class="form-control" id="city" name="city" placeholder="Enter the city name">
                                <p id="cityerr" class="err"></p>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-xs-12 col-sm-12 col-md-2 col-lg-2">
                                <label class="control-label" for="state" id="label">State: <span id="asterisk">*</span></label>
                                <select class="form-control" id="state" name="state">
                                    <option value="">Select your state...</option>
                                    <option value="AB">Albama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="DC">District Of Columbia</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA">Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                                <p id="stateerr" class="err"></p>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-xs-12 col-sm-12 col-md-2 col-lg-3">
                                <label class="control-label" id="label">Degree: <span id="asterisk">*</span></label>
                                <div class="form-group">
                                    <label class="radio-inline" id="label">
                                        <input type="radio" id="degreef" name="degree" value="Fahrenheit" checked="true">Fahrenheit
                                    </label>
                                    <label class="radio-inline" id="label">
                                        <input type="radio" id="degreec" name="degree" value="Celsius">Celsius
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                   			<div class="col-xs-12 col-sm-12 col-md-3 col-lg-1">
                                <label class="control-label" for="city" id="label"></label>
                                <input type="hidden" class="form-control" id="city" name="city"></div>
                            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-2 " style="text-align: right">
                                <button type="button" class="btn btn-primary btn-sm" id="search" name="search">
                                    <span class="glyphicon glyphicon-search"></span> Search
                                </button>
                                <button type="button" class="btn btn-default btn-sm" id="clear" name="clear" onclick="clearscreen()">
                                    <span class="glyphicon glyphicon-refresh"></span> Clear
                                </button>
								<br>
                                <label class="control-label" id="label">Powered By:</label>
                                 <a href="http://forecast.io" target="_blank"><img src="http://cs-server.usc.edu:45678/hw/hw8/images/forecast_logo.png" alt="Forecast IO" width="65" height="70"></a>
                            </div>
                        </div>

                    </form>
 					</section>

                   </div>
        </div><!-- row -->


    <hr>
      <div id="displaydiv">
    
      <div id="forecastResultsDiv" style="display: none;">
                                <ul class="nav nav-tabs" id="weatherTabs">
                                        <li role="presentation" class="active" style="background-color:white"><a href="#rightNow">Right Now</a></li>
                                        <li role="presentation" style="background-color:white"><a href="#next24Hours">Next 24 Hours</a></li>
                                        <li role="presentation" style="background-color:white"><a href="#next7Days">Next 7 Days</a></li>
                                </ul>

                                <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="rightNow">
                                                <div class="row">
                                                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="rightNowVisual">
                                                        </div>
                                                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="rightNowMap" style="height: 460px; padding-left: 0px; padding-right: 0px;">

                                                          <div id="basicMap">
                                                                </div>
                                                        </div>
                                                </div>
                                        </div>

                                        <div role="tabpanel" class="tab-pane" id="next24Hours">
                                                <div class="row">
                                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="next24HoursVisual">
                                                                
                                                        </div>
                                                </div>
                                        </div>

                                        <div role="tabpanel" class="tab-pane" id="next7Days">
                                                <div class="row" id="next7DaysVisual" style="background: #2F3439;">

                                                </div>
                                        </div>
                                </div>
                        </div>

    </div>
    </div>

<noscript>
</body>
</html>								
